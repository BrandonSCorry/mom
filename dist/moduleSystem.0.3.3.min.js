/**
 * moduleSystem
 * Dynamic Loading of Javascript based on DOM elements
 * @version v0.3.3 - 2014-09-25 * @link 
 * @author Eder Alexander <eder.alexan@gmail.com>
 * @license MIT License, http://www.opensource.org/licenses/MIT
 */var moduleLoader=function(a,b,c){"use strict";function d(){function d(){var b,c,d,e,f,i,j,k,l=[];for(b in a)a.hasOwnProperty(b)&&(c=a[b],l.push(c));if(l.length>0){do for(j=l,l=[],d=0;d<j.length;d++)c=j[d],e=c.dependencies,f=g(e),f.length===e.length?(k=f,void 0!==c.settings&&k.unshift(c.settings),i=c.creator.apply(null,k),void 0===i&&(i={}),h[c.name]=i):l.push(c);while(j.length>l.length);if(l.length>0)throw new Error("provision error can't resolve dependencies for parts:"+JSON.stringify(l))}}function e(){function a(a,b){var c=a.find('script[type="'+b+'/settings"]'),d=c.html();return void 0!==d?$.parseJSON(d):void 0}function d(a){$.each(a,function(a,b){"function"==typeof b.postConstruct&&b.postConstruct()})}var e=$("[data-module]");e.each(function(d,e){var h=$(e),j=h.data("module").split(",");$.each(j,function(d,e){var j,k,l,m,n,o,p;if(!b.hasOwnProperty(e))throw new Error("Module "+e+" not registered but found in dom");if(j=b[e],m=g(j.dependencies),m.length!==j.dependencies.length)throw new Error("Required Parts Missing from "+e+" dependencies: "+JSON.stringify(j.dependencies));n=m,o=a(h,e),(void 0!==j.settings||void 0!==o)&&(p=$.extend({},j.settings,o),n.unshift(p)),n.unshift(h),k=j.creator.apply(null,n),void 0===k&&(k={}),l=f(j.name),k.name=l,i[l]=k,c.add(k)})}),d(h),d(i)}function f(a){var b,c=0;do b=a+c,c++;while(i.hasOwnProperty(b));return b}function g(a){var b=[];return a.length>0&&$.each(a,function(){if(h.hasOwnProperty(this)){var a=h[this];b.push(a)}}),b}var h={},i={};d(),e()}function e(){function c(a){for(var b in a)a.hasOwnProperty(b)&&delete a[b]}c(a),c(b)}return{initModulePage:d,reset:e}},moduleBuilder=function(){"use strict";function a(a){return function(b){function c(c){var d={creator:c,name:b,dependencies:g,settings:f};if(a.hasOwnProperty(b))throw new Error(b+" already registered");a[b]=d}function d(a){return f=a,{dependencies:e,creator:c}}function e(a){return $.isArray(a)||(a=[a]),g=a,{settings:d,creator:c}}if("string"!=typeof b)throw new Error("Name missing");var f,g=[];return{settings:d,dependencies:e,creator:c}}}function b(){function a(a){for(var b in a)a.hasOwnProperty(b)&&delete a[b]}a(d),a(c)}var c={},d={};return{createPart:a(d),createModule:a(c),modules:c,parts:d,reset:b}},eventBus=function(){"use strict";function a(a){this.name=a,this.getData=function(){var a={};for(var b in this)this.hasOwnProperty(b)&&"name"!==b&&"getData"!==b&&(a[b]=this[b]);return a}}function b(a,b){if("undefined"!=typeof a&&"undefined"!=typeof a.name){var c,d,e,g="on"+a.name;for(c in f)f.hasOwnProperty(c)&&(d=f[c],e=d[g],"function"==typeof e&&(b=b||d,e.call(b,a.getData())))}}function c(a,b){if("undefined"==typeof a)throw new Error("Component to be registered is undefined");if("undefined"==typeof a.name)throw new Error("Component name to be registered is undefined");if(a.name in f){if(!b)throw new Error("Component with name ["+a.name+"] already registered");d(a.name)}f[a.name]=a}function d(a){a in f&&delete f[a]}function e(){f={}}var f={},g=new a,h={register:function(a,b){if("function"!=typeof a)throw new Error("No Event provided");if(b in h)throw new Error("Error registering event, duplicate Event with name ["+b+"]");return a.prototype=g,h[b]=a,a}};return{publish:b,add:c,remove:d,reset:e,Events:h}}(),moduleSystem=function(a,b,c){"use strict";function d(){e.reset(),f.reset()}var e=a(),f=b(e.parts,e.modules,c);return e.createPart("eventBus").creator(function(){return c}),{createPart:e.createPart,createModule:e.createModule,initModulePage:f.initModulePage,reset:d}}(moduleBuilder,moduleLoader,eventBus);