/**
 * moduleSystem
 * Dynamic Loading of Javascript based on DOM elements
 * @version v0.3.3 - 2014-10-04 * @link 
 * @author Eder Alexander <eder.alexan@gmail.com>
 * @license MIT License, http://www.opensource.org/licenses/MIT
 */var moduleLoader=function(a,b){"use strict";function c(){function c(){var c=$("[data-module]");c.each(function(b,c){$(c);a.provisionModule($(c))}),b.provisionFinished(),a.provisionFinished()}c()}return{initModulePage:c}},moduleBuilder=function(a,b){"use strict";function c(a){return function(b){function c(c){var d={creator:c,name:b,dependencies:g,settings:f};a(d)}function d(a){return f=a,{dependencies:e,creator:c}}function e(a){return $.isArray(a)||(a=[a]),g=a,{settings:d,creator:c}}if("string"!=typeof b)throw new Error("Name missing");var f,g=[];return{settings:d,dependencies:e,creator:c}}}return{createPart:c(b.addPartDescriptor),createModule:c(a.addModuleDescriptor)}},partAccess=function(){"use strict";function a(a){i[a.name]=a}function b(a){var b=[];return $.each(a,function(a,d){b.push(c(d))}),b}function c(a){var b=h[a];return void 0===b&&(b=d(a)),b}function d(a){var c,d,f;if(i.hasOwnProperty(a))return f=i[a],c=f.dependencies,d=b(c),e(f,d);throw new Error("tried to load "+a+"but was not registered")}function e(a,b){var c,d;return c=b,void 0!==a.settings&&c.unshift(a.settings),d=a.creator.apply(null,c),void 0===d&&(d={}),h[a.name]=d,d}function f(){function a(a){$.each(a,function(a,b){"function"==typeof b.postConstruct&&b.postConstruct()})}a(h)}function g(){h={},i={}}var h={},i={};return{reset:g,provisionPart:c,getParts:b,provisionFinished:f,addPartDescriptor:a}},moduleAccess=function(a,b){"use strict";function c(a){k[a.name]=a}function d(b){var c,d,f=b.data("module");if(!k.hasOwnProperty(f))throw new Error("Module "+f+" not registered but found in dom");if(c=k[f],d=a.getParts(c.dependencies),d.length!==c.dependencies.length)throw new Error("Required Parts Missing from "+f+" dependencies: "+JSON.stringify(c.dependencies));e(b,c,d)}function e(a,c,d){var e,h,i,k=d,l=f(a,c.name);(void 0!==c.settings||void 0!==l)&&(e=$.extend({},c.settings,l),k.unshift(e)),k.unshift(a),h=c.creator.apply(null,k),void 0===h&&(h={}),i=g(c.name),h.name=i,j[i]=h,b.add(h)}function f(a,b){var c=a.find('script[type="'+b+'/settings"]'),d=c.html();return void 0!==d?$.parseJSON(d):void 0}function g(a){var b,c=0;do b=a+c,c++;while(j.hasOwnProperty(b));return b}function h(){function a(a){$.each(a,function(a,b){"function"==typeof b.postConstruct&&b.postConstruct()})}a(j)}function i(){j={},k={}}var j={},k={};return{reset:i,provisionModule:d,provisionFinished:h,addModuleDescriptor:c}},eventBus=function(){"use strict";function a(a){this.name=a,this.getData=function(){var a={};for(var b in this)this.hasOwnProperty(b)&&"name"!==b&&"getData"!==b&&(a[b]=this[b]);return a}}function b(a,b){if("undefined"!=typeof a&&"undefined"!=typeof a.name){var c,d,e,g="on"+a.name;for(c in f)f.hasOwnProperty(c)&&(d=f[c],e=d[g],"function"==typeof e&&(b=b||d,e.call(b,a.getData())))}}function c(a,b){if("undefined"==typeof a)throw new Error("Component to be registered is undefined");if("undefined"==typeof a.name)throw new Error("Component name to be registered is undefined");if(a.name in f){if(!b)throw new Error("Component with name ["+a.name+"] already registered");d(a.name)}f[a.name]=a}function d(a){a in f&&delete f[a]}function e(){f={}}var f={},g=new a,h={register:function(a,b){if("function"!=typeof a)throw new Error("No Event provided");if(b in h)throw new Error("Error registering event, duplicate Event with name ["+b+"]");return a.prototype=g,h[b]=a,a}};return{publish:b,add:c,remove:d,reset:e,Events:h}}(),moduleSystem=function(a,b,c,d,e){"use strict";function f(){g.reset(),h.reset(),i.createPart("eventBus").creator(function(){return e})}var g=c(),h=d(g,e),i=a(h,g),j=b(h,g);return i.createPart("eventBus").creator(function(){return e}),{createPart:i.createPart,createModule:i.createModule,initModulePage:j.initModulePage,reset:f}}(moduleBuilder,moduleLoader,partAccess,moduleAccess,eventBus);