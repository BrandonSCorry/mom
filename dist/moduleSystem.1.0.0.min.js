/**
 * moduleSystem
 * Dynamic Loading of Javascript based on DOM elements
 * @version v1.0.0 - 2014-11-05 * @link 
 * @author Eder Alexander <eder.alexan@gmail.com>
 * @license MIT License, http://www.opensource.org/licenses/MIT
 */!function(a,b,c){"use strict";var d=function(a,c){function d(){function d(){var d,f,g=b.querySelectorAll("[modules]");for(d=0;d<g.length;d++)f=g[d],e(f);c.provisionFinished(),a.provisionFinished()}function e(b){a.provisionModule(b)}d()}return{initModulePage:d}},e=function(a,b){function c(a){return function(b){function c(c){var d={creator:c,name:b,dependencies:g,settings:f};a(d)}function d(a){return f=a,{dependencies:e,creator:c}}function e(a){return $.isArray(a)||(a=[a]),g=a,{settings:d,creator:c}}if("string"!=typeof b)throw new Error("Name missing");var f,g=[];return{settings:d,dependencies:e,creator:c}}}return{createPart:c(b.addPartDescriptor),createModule:c(a.addModuleDescriptor)}},f=function(){function a(a){j[a.name]=a}function b(a){var b=[];return $.each(a,function(a,c){b.push(d(c))}),b}function d(a){var b=i[a];return b===c&&(b=e(a)),b}function e(a){var c,d,e;if(j.hasOwnProperty(a))return e=j[a],c=e.dependencies,d=b(c),f(e,d);throw new Error("tried to load "+a+"but was not registered")}function f(a,b){var d,e;return d=b,a.settings!==c&&d.unshift(a.settings),e=a.creator.apply(null,d),e===c&&(e={}),i[a.name]=e,e}function g(){function a(a){$.each(a,function(a,b){"function"==typeof b.postConstruct&&b.postConstruct()})}a(i)}function h(){i={},j={}}var i={},j={};return{reset:h,provisionPart:d,getParts:b,provisionFinished:g,addPartDescriptor:a}},g=function(a,b){function d(a){m[a.name]=a}function e(a){var b,c,d=a.getAttribute("modules"),e=d.split(",");for(b=0;b<e.length;b++)c=e[b].trim(),f($(a),c)}function f(b,c){var d,e;if(!m.hasOwnProperty(c))throw new Error("Module "+c+" not registered but found in dom");if(d=m[c],e=a.getParts(d.dependencies),e.length!==d.dependencies.length)throw new Error("Required Parts Missing from "+c+" dependencies: "+JSON.stringify(d.dependencies));g(b,d,e)}function g(a,d,e){var f,g,j,k=e,m=h(a,d.name);(d.settings!==c||m!==c)&&(f=$.extend({},d.settings,m),k.unshift(f)),k.unshift(a.get(0)),g=d.creator.apply(null,k),g===c&&(g={}),j=i(d.name),g.name=j,l[j]=g,b.add(g)}function h(a,b){var d=a.find('script[type="'+b+'/settings"]'),e=d.html();return e!==c?$.parseJSON(e):void 0}function i(a){var b,c=0;do b=a+c,c++;while(l.hasOwnProperty(b));return b}function j(){function a(a){$.each(a,function(a,b){"function"==typeof b.postConstruct&&b.postConstruct()})}a(l)}function k(){l={},m={}}var l={},m={};return{reset:k,provisionModule:e,provisionFinished:j,addModuleDescriptor:d}},h=function(){function a(a){this.name=a,this.getData=function(){var a={};for(var b in this)this.hasOwnProperty(b)&&"name"!==b&&"getData"!==b&&(a[b]=this[b]);return a}}function b(a,b){if(typeof a!==c&&typeof a.name!==c){var d,e,f,h="on"+a.name;for(d in g)g.hasOwnProperty(d)&&(e=g[d],f=e[h],"function"==typeof f&&(b=b||e,f.call(b,a.getData())))}}function d(a,b){if(typeof a===c)throw new Error("Component to be registered is undefined");if(typeof a.name===c)throw new Error("Component name to be registered is undefined");if(a.name in g){if(!b)throw new Error("Component with name ["+a.name+"] already registered");e(a.name)}g[a.name]=a}function e(a){a in g&&delete g[a]}function f(){g={}}var g={},h=new a,i={register:function(a,b){if("function"!=typeof a)throw new Error("No Event provided");if(b in i)throw new Error("Error registering event, duplicate Event with name ["+b+"]");return a.prototype=h,i[b]=a,a}};return{publish:b,add:d,remove:e,reset:f,Events:i}}();a.moduleSystem=function(a,b,c,d,e){function f(){g.reset(),h.reset(),e.reset(),i.createPart("eventBus").creator(function(){return e})}var g=c(),h=d(g,e),i=a(h,g),j=b(h,g);return i.createPart("eventBus").creator(function(){return e}),{createPart:i.createPart,createModule:i.createModule,initModulePage:j.initModulePage,reset:f,getPart:g.provisionPart}}(e,d,f,g,h)}(window,document);