/**
 * moduleSystem
 * Dynamic Loading of Javascript based on DOM elements
 * @version v1.1.0 - 2014-11-21 * @link 
 * @author Eder Alexander <eder.alexan@gmail.com>
 * @license MIT License, http://www.opensource.org/licenses/MIT
 */!function(a,b,c){function d(a,b){"use strict";var c,d,e,f=a.length;for(c=0;f>c&&(d=a[c],!(e=b(c,d)));c++);}function e(a,b){"use strict";var c,d,e=a.length,f=!1;for(c=0;e>c;c++)if(d=a[c],d===b){f=!0;break}return f}function f(a,b){"use strict";var c,d,e;for(c in a)if(a.hasOwnProperty(c)&&(d=a[c],e=b(c,d)))break}function g(){"use strict";function a(a){if(a!==c){var e="on"+a.name;d(i,function(d,f){a.name!==c&&b(f,e,a),b(f,h,a)})}}function b(a,b,c){var d=a[b];"function"==typeof d&&d.call(null,c)}function f(a){if(a===c)throw new Error("Component to be registered is undefined");if(e(i,a))throw new Error("Component is already registered");i.push(a)}function g(){i=[]}var h="onEvent",i=[];return{publish:a,add:f,reset:g}}var h=function(a,c){"use strict";function e(){function e(){var e=b.querySelectorAll("[modules]");d(e,function(a,b){f(b)}),c.provisionFinished(),a.provisionFinished()}function f(b){a.provisionModule(b)}e()}return{initModulePage:e}},i=function(a,b){"use strict";function c(a){return function(b){function c(c){var d={creator:c,name:b,dependencies:g,settings:f};a(d)}function d(a){return f=a,{dependencies:e,creator:c}}function e(a){return g=a,{settings:d,creator:c}}if("string"!=typeof b)throw new Error("Name missing");var f,g=[];return{settings:d,dependencies:e,creator:c}}}return{createPart:c(b.addPartDescriptor),createModule:c(a.addModuleDescriptor)}},j=function(){"use strict";function a(a){l[a.name]=a}function b(a){var b=[];return d(a,function(a,c){b.push(e(c))}),b}function e(a){var b=k[a];return b===c&&(b=g(a)),b}function g(a){var c,d,e;if(l.hasOwnProperty(a))return e=l[a],c=e.dependencies,d=b(c),h(e,d);throw new Error("tried to load "+a+"but was not registered")}function h(a,b){var d,e;return d=b,a.settings!==c&&d.unshift(a.settings),e=a.creator.apply(null,d),e===c&&(e={}),k[a.name]=e,e}function i(){function a(a){f(a,function(a,b){"function"==typeof b.postConstruct&&b.postConstruct()})}a(k)}function j(){k={},l={}}var k={},l={};return{reset:j,provisionPart:e,getParts:b,provisionFinished:i,addPartDescriptor:a}},k=function(a,b){"use strict";function e(a){o[a.name]=a}function g(a){var b=a.getAttribute("modules"),c=b.split(",");d(c,function(b,c){c=c.trim(),h(a,c)})}function h(b,c){var d,e;if(!o.hasOwnProperty(c))throw new Error("Module "+c+" not registered but found in dom");if(d=o[c],e=a.getParts(d.dependencies),e.length!==d.dependencies.length)throw new Error("Required Parts Missing from "+c+" dependencies: "+JSON.stringify(d.dependencies));i(b,d,e)}function i(a,d,e){var f,g,h,i=e,k=j(a,d.name);(d.settings!==c||k!==c)&&(f=l({},d.settings,k),i.unshift(f)),i.unshift(a),g=d.creator.apply(null,i),g===c&&(g={}),n[h]=g,b.add(g)}function j(a,b){var c,d,e=a.querySelector('script[type="'+b+'/settings"]');return null!==e&&(c=e.innerHTML,d=JSON.parse(c)),d}function k(){f(n,function(a,b){var c=b.postConstruct;"function"==typeof c&&c.call(b)})}function l(){var a=arguments[0];return d(arguments,function(b,c){b>0&&f(c,function(b,c){a[b]=c})}),a}function m(){n={},o={}}var n={},o={};return{reset:m,provisionModule:g,provisionFinished:k,addModuleDescriptor:e}};moduleSystem=function(a,b,c,d,e){"use strict";function f(){g.reset(),i.reset(),h.reset(),j.createPart("eventBus").creator(function(){return h})}var g=c(),h=e(),i=d(g,h),j=a(i,g),k=b(i,g);return j.createPart("eventBus").creator(function(){return h}),{createPart:j.createPart,createModule:j.createModule,initModulePage:k.initModulePage,reset:f,getPart:g.provisionPart}}(i,h,j,k,g)}(window,document);