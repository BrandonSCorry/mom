/**
 * moduleSystem
 * Dynamic Loading of Javascript based on DOM elements
 * @version v1.0.0 - 2014-10-26 * @link 
 * @author Eder Alexander <eder.alexan@gmail.com>
 * @license MIT License, http://www.opensource.org/licenses/MIT
 */!function(a,b){"use strict";var c=function(a,b){function c(){function c(){var c=$("[data-module]");c.each(function(b,c){$(c);a.provisionModule($(c))}),b.provisionFinished(),a.provisionFinished()}c()}return{initModulePage:c}},d=function(a,b){function c(a){return function(b){function c(c){var d={creator:c,name:b,dependencies:g,settings:f};a(d)}function d(a){return f=a,{dependencies:e,creator:c}}function e(a){return $.isArray(a)||(a=[a]),g=a,{settings:d,creator:c}}if("string"!=typeof b)throw new Error("Name missing");var f,g=[];return{settings:d,dependencies:e,creator:c}}}return{createPart:c(b.addPartDescriptor),createModule:c(a.addModuleDescriptor)}},e=function(){function a(a){j[a.name]=a}function c(a){var b=[];return $.each(a,function(a,c){b.push(d(c))}),b}function d(a){var c=i[a];return c===b&&(c=e(a)),c}function e(a){var b,d,e;if(j.hasOwnProperty(a))return e=j[a],b=e.dependencies,d=c(b),f(e,d);throw new Error("tried to load "+a+"but was not registered")}function f(a,c){var d,e;return d=c,a.settings!==b&&d.unshift(a.settings),e=a.creator.apply(null,d),e===b&&(e={}),i[a.name]=e,e}function g(){function a(a){$.each(a,function(a,b){"function"==typeof b.postConstruct&&b.postConstruct()})}a(i)}function h(){i={},j={}}var i={},j={};return{reset:h,provisionPart:d,getParts:c,provisionFinished:g,addPartDescriptor:a}},f=function(a,c){function d(a){m[a.name]=a}function e(a){var b=a.data("module");$.each(b.split(","),function(b,c){c=c.trim(),f(a,c)})}function f(b,c){var d,e;if(!m.hasOwnProperty(c))throw new Error("Module "+c+" not registered but found in dom");if(d=m[c],e=a.getParts(d.dependencies),e.length!==d.dependencies.length)throw new Error("Required Parts Missing from "+c+" dependencies: "+JSON.stringify(d.dependencies));g(b,d,e)}function g(a,d,e){var f,g,j,k=e,m=h(a,d.name);(d.settings!==b||m!==b)&&(f=$.extend({},d.settings,m),k.unshift(f)),k.unshift(a),g=d.creator.apply(null,k),g===b&&(g={}),j=i(d.name),g.name=j,l[j]=g,c.add(g)}function h(a,c){var d=a.find('script[type="'+c+'/settings"]'),e=d.html();return e!==b?$.parseJSON(e):void 0}function i(a){var b,c=0;do b=a+c,c++;while(l.hasOwnProperty(b));return b}function j(){function a(a){$.each(a,function(a,b){"function"==typeof b.postConstruct&&b.postConstruct()})}a(l)}function k(){l={},m={}}var l={},m={};return{reset:k,provisionModule:e,provisionFinished:j,addModuleDescriptor:d}},g=function(){function a(a){this.name=a,this.getData=function(){var a={};for(var b in this)this.hasOwnProperty(b)&&"name"!==b&&"getData"!==b&&(a[b]=this[b]);return a}}function b(a,b){if("undefined"!=typeof a&&"undefined"!=typeof a.name){var c,d,e,g="on"+a.name;for(c in f)f.hasOwnProperty(c)&&(d=f[c],e=d[g],"function"==typeof e&&(b=b||d,e.call(b,a.getData())))}}function c(a,b){if("undefined"==typeof a)throw new Error("Component to be registered is undefined");if("undefined"==typeof a.name)throw new Error("Component name to be registered is undefined");if(a.name in f){if(!b)throw new Error("Component with name ["+a.name+"] already registered");d(a.name)}f[a.name]=a}function d(a){a in f&&delete f[a]}function e(){f={}}var f={},g=new a,h={register:function(a,b){if("function"!=typeof a)throw new Error("No Event provided");if(b in h)throw new Error("Error registering event, duplicate Event with name ["+b+"]");return a.prototype=g,h[b]=a,a}};return{publish:b,add:c,remove:d,reset:e,Events:h}}();a.moduleSystem=function(a,b,c,d,e){function f(){g.reset(),h.reset(),e.reset(),i.createPart("eventBus").creator(function(){return e})}var g=c(),h=d(g,e),i=a(h,g),j=b(h,g);return i.createPart("eventBus").creator(function(){return e}),{createPart:i.createPart,createModule:i.createModule,initModulePage:j.initModulePage,reset:f,getPart:g.provisionPart}}(d,c,e,f,g)}(window);